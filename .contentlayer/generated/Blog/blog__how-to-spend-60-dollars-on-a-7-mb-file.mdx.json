{
  "title": "How to Spend $60 to Store a 7mb File - Or Why You Should Write Unit Tests",
  "date": "2020-11-18T15:33:55.000Z",
  "tags": [],
  "draft": false,
  "summary": "",
  "body": {
    "raw": "I'm not the best at writing automated tests. Sometimes I write them as I go, sometimes I write them before checking my code in, and sometimes I don't write them at all. This is bad practice, and I acknowledge it's an area where I need to improve. And today, I'll walk you through exactly why you shouldn't be like me.\n\nA little background first:\n\nI'm working on a project for my company, [Pinata](<https://pinata.cloud/>), where we interact with the [Filecoin](<https://filecoin.io/>) blockchain. Filecoin works as an open-market, long-term storage solution for content. Unlike using a service like Amazon S3 Glacier, you can search for a storage provider (called miners) with rates you like and choose that provider to store your content for an agreed amount period of time. At the time of this writing, the minimum amount of time a storage deal can be made for is about six months.\n\nAs part of the process for finding storage providers and proposing a \"contract\" to store the content, it is important (to us at least) to convert the cost of storage to USD. However, the conversion is not exactly straight forward.\n\nStorage providers provide quotes for storage in a format called AttoFil. This is the smallest denomination of the Filecoin currency called FIL. One AttoFil is 10^-18 FIL. The quoted price is also for a single epoch of time (approximately 30 seconds) and is per GB. So for example, if someone quoted `500000000`, the calculation for cost in FIL for 30 seconds of storage would be:\n\n```\n(500000000 * Math.pow(10, -18)\n```\n\nThat's pretty straight forward so far. But there are three additional variables missing in order to achieve our goal. We are storing content for about six months (In Epochs), we are not storing exactly one GB each time, and we need to know that we are not overpaying in USD.\n\nThe first step was to calculate the current cost of FIL in USD. That's pretty easy. As of right now, the price of one FIL is $28.48. Next, we need to figure out what the cost of one AttoFil is in USD. To do that, we take `28.48 * Math.pow(10, -18)`. Next, we need to figure out the size of our file to store in bytes and convert that to GB. There are many ways to do this, but for simplicity, the calculation is essentially this:\n\n```\nconst sizeInKb = FileSize/1024;\nconst sizeInMb = sizeInKb/1024;\nconst sizeInGb = sizeInMb/1024;\n```\n\nNow, we need to calculate how many epochs (30 second periods of time) there are in six months. I'll save you the math and tell you it's about 518400 epochs.\n\nWith all of this information, the trick is calculating the right price to propose to the storage provider. There's no going back if they accept the proposal...even if you mess up and overpay. And that's exactly what happened to me.\n\nI did not have a unit test in place to verify the price we would be paying did not exceed the price in USD we were comfortable with for six months of storage for any given file size. Because of this, I happened to query a storage provider who quoted a verify high price and a bug in my code missed the verification calculation. So, we ended up paying $60 to store a file that was about 7MB for six months.\n\nThe moral of this story is test, test, test.\n\n\n  \n",
    "code": "var Component=(()=>{var un=Object.create;var P=Object.defineProperty;var dn=Object.getOwnPropertyDescriptor;var cn=Object.getOwnPropertyNames;var fn=Object.getPrototypeOf,mn=Object.prototype.hasOwnProperty;var G=(d,r)=>()=>(r||d((r={exports:{}}).exports,r),r.exports),bn=(d,r)=>{for(var h in r)P(d,h,{get:r[h],enumerable:!0})},Ne=(d,r,h,x)=>{if(r&&typeof r==\"object\"||typeof r==\"function\")for(let g of cn(r))!mn.call(d,g)&&g!==h&&P(d,g,{get:()=>r[g],enumerable:!(x=dn(r,g))||x.enumerable});return d};var pn=(d,r,h)=>(h=d!=null?un(fn(d)):{},Ne(r||!d||!d.__esModule?P(h,\"default\",{value:d,enumerable:!0}):h,d)),hn=d=>Ne(P({},\"__esModule\",{value:!0}),d);var we=G((yn,ye)=>{ye.exports=React});var je=G(q=>{\"use strict\";(function(){\"use strict\";var d=we(),r=Symbol.for(\"react.element\"),h=Symbol.for(\"react.portal\"),x=Symbol.for(\"react.fragment\"),g=Symbol.for(\"react.strict_mode\"),K=Symbol.for(\"react.profiler\"),H=Symbol.for(\"react.provider\"),X=Symbol.for(\"react.context\"),k=Symbol.for(\"react.forward_ref\"),F=Symbol.for(\"react.suspense\"),I=Symbol.for(\"react.suspense_list\"),R=Symbol.for(\"react.memo\"),A=Symbol.for(\"react.lazy\"),Re=Symbol.for(\"react.offscreen\"),Z=Symbol.iterator,Te=\"@@iterator\";function Ue(e){if(e===null||typeof e!=\"object\")return null;var n=Z&&e[Z]||e[Te];return typeof n==\"function\"?n:null}var y=d.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function m(e){{for(var n=arguments.length,t=new Array(n>1?n-1:0),i=1;i<n;i++)t[i-1]=arguments[i];Se(\"error\",e,t)}}function Se(e,n,t){{var i=y.ReactDebugCurrentFrame,s=i.getStackAddendum();s!==\"\"&&(n+=\"%s\",t=t.concat([s]));var u=t.map(function(l){return String(l)});u.unshift(\"Warning: \"+n),Function.prototype.apply.call(console[e],console,u)}}var Ce=!1,Oe=!1,Pe=!1,Fe=!1,Ie=!1,J;J=Symbol.for(\"react.module.reference\");function Ae(e){return!!(typeof e==\"string\"||typeof e==\"function\"||e===x||e===K||Ie||e===g||e===F||e===I||Fe||e===Re||Ce||Oe||Pe||typeof e==\"object\"&&e!==null&&(e.$$typeof===A||e.$$typeof===R||e.$$typeof===H||e.$$typeof===X||e.$$typeof===k||e.$$typeof===J||e.getModuleId!==void 0))}function We(e,n,t){var i=e.displayName;if(i)return i;var s=n.displayName||n.name||\"\";return s!==\"\"?t+\"(\"+s+\")\":t}function Q(e){return e.displayName||\"Context\"}function _(e){if(e==null)return null;if(typeof e.tag==\"number\"&&m(\"Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue.\"),typeof e==\"function\")return e.displayName||e.name||null;if(typeof e==\"string\")return e;switch(e){case x:return\"Fragment\";case h:return\"Portal\";case K:return\"Profiler\";case g:return\"StrictMode\";case F:return\"Suspense\";case I:return\"SuspenseList\"}if(typeof e==\"object\")switch(e.$$typeof){case X:var n=e;return Q(n)+\".Consumer\";case H:var t=e;return Q(t._context)+\".Provider\";case k:return We(e,e.render,\"ForwardRef\");case R:var i=e.displayName||null;return i!==null?i:_(e.type)||\"Memo\";case A:{var s=e,u=s._payload,l=s._init;try{return _(l(u))}catch{return null}}}return null}var N=Object.assign,E=0,ee,ne,re,te,ae,ie,oe;function le(){}le.__reactDisabledLog=!0;function $e(){{if(E===0){ee=console.log,ne=console.info,re=console.warn,te=console.error,ae=console.group,ie=console.groupCollapsed,oe=console.groupEnd;var e={configurable:!0,enumerable:!0,value:le,writable:!0};Object.defineProperties(console,{info:e,log:e,warn:e,error:e,group:e,groupCollapsed:e,groupEnd:e})}E++}}function Me(){{if(E--,E===0){var e={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:N({},e,{value:ee}),info:N({},e,{value:ne}),warn:N({},e,{value:re}),error:N({},e,{value:te}),group:N({},e,{value:ae}),groupCollapsed:N({},e,{value:ie}),groupEnd:N({},e,{value:oe})})}E<0&&m(\"disabledDepth fell below zero. This is a bug in React. Please file an issue.\")}}var W=y.ReactCurrentDispatcher,$;function T(e,n,t){{if($===void 0)try{throw Error()}catch(s){var i=s.stack.trim().match(/\\n( *(at )?)/);$=i&&i[1]||\"\"}return`\n`+$+e}}var M=!1,U;{var Ye=typeof WeakMap==\"function\"?WeakMap:Map;U=new Ye}function se(e,n){if(!e||M)return\"\";{var t=U.get(e);if(t!==void 0)return t}var i;M=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var u;u=W.current,W.current=null,$e();try{if(n){var l=function(){throw Error()};if(Object.defineProperty(l.prototype,\"props\",{set:function(){throw Error()}}),typeof Reflect==\"object\"&&Reflect.construct){try{Reflect.construct(l,[])}catch(v){i=v}Reflect.construct(e,[],l)}else{try{l.call()}catch(v){i=v}e.call(l.prototype)}}else{try{throw Error()}catch(v){i=v}e()}}catch(v){if(v&&i&&typeof v.stack==\"string\"){for(var o=v.stack.split(`\n`),b=i.stack.split(`\n`),c=o.length-1,f=b.length-1;c>=1&&f>=0&&o[c]!==b[f];)f--;for(;c>=1&&f>=0;c--,f--)if(o[c]!==b[f]){if(c!==1||f!==1)do if(c--,f--,f<0||o[c]!==b[f]){var p=`\n`+o[c].replace(\" at new \",\" at \");return e.displayName&&p.includes(\"<anonymous>\")&&(p=p.replace(\"<anonymous>\",e.displayName)),typeof e==\"function\"&&U.set(e,p),p}while(c>=1&&f>=0);break}}}finally{M=!1,W.current=u,Me(),Error.prepareStackTrace=s}var j=e?e.displayName||e.name:\"\",xe=j?T(j):\"\";return typeof e==\"function\"&&U.set(e,xe),xe}function Le(e,n,t){return se(e,!1)}function Ve(e){var n=e.prototype;return!!(n&&n.isReactComponent)}function S(e,n,t){if(e==null)return\"\";if(typeof e==\"function\")return se(e,Ve(e));if(typeof e==\"string\")return T(e);switch(e){case F:return T(\"Suspense\");case I:return T(\"SuspenseList\")}if(typeof e==\"object\")switch(e.$$typeof){case k:return Le(e.render);case R:return S(e.type,n,t);case A:{var i=e,s=i._payload,u=i._init;try{return S(u(s),n,t)}catch{}}}return\"\"}var C=Object.prototype.hasOwnProperty,ue={},de=y.ReactDebugCurrentFrame;function O(e){if(e){var n=e._owner,t=S(e.type,e._source,n?n.type:null);de.setExtraStackFrame(t)}else de.setExtraStackFrame(null)}function ze(e,n,t,i,s){{var u=Function.call.bind(C);for(var l in e)if(u(e,l)){var o=void 0;try{if(typeof e[l]!=\"function\"){var b=Error((i||\"React class\")+\": \"+t+\" type `\"+l+\"` is invalid; it must be a function, usually from the `prop-types` package, but received `\"+typeof e[l]+\"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.\");throw b.name=\"Invariant Violation\",b}o=e[l](n,l,i,t,null,\"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED\")}catch(c){o=c}o&&!(o instanceof Error)&&(O(s),m(\"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).\",i||\"React class\",t,l,typeof o),O(null)),o instanceof Error&&!(o.message in ue)&&(ue[o.message]=!0,O(s),m(\"Failed %s type: %s\",t,o.message),O(null))}}}var Be=Array.isArray;function Y(e){return Be(e)}function Ge(e){{var n=typeof Symbol==\"function\"&&Symbol.toStringTag,t=n&&e[Symbol.toStringTag]||e.constructor.name||\"Object\";return t}}function qe(e){try{return ce(e),!1}catch{return!0}}function ce(e){return\"\"+e}function fe(e){if(qe(e))return m(\"The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.\",Ge(e)),ce(e)}var D=y.ReactCurrentOwner,Ke={key:!0,ref:!0,__self:!0,__source:!0},me,be,L;L={};function He(e){if(C.call(e,\"ref\")){var n=Object.getOwnPropertyDescriptor(e,\"ref\").get;if(n&&n.isReactWarning)return!1}return e.ref!==void 0}function Xe(e){if(C.call(e,\"key\")){var n=Object.getOwnPropertyDescriptor(e,\"key\").get;if(n&&n.isReactWarning)return!1}return e.key!==void 0}function Ze(e,n){if(typeof e.ref==\"string\"&&D.current&&n&&D.current.stateNode!==n){var t=_(D.current.type);L[t]||(m('Component \"%s\" contains the string ref \"%s\". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',_(D.current.type),e.ref),L[t]=!0)}}function Je(e,n){{var t=function(){me||(me=!0,m(\"%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)\",n))};t.isReactWarning=!0,Object.defineProperty(e,\"key\",{get:t,configurable:!0})}}function Qe(e,n){{var t=function(){be||(be=!0,m(\"%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)\",n))};t.isReactWarning=!0,Object.defineProperty(e,\"ref\",{get:t,configurable:!0})}}var en=function(e,n,t,i,s,u,l){var o={$$typeof:r,type:e,key:n,ref:t,props:l,_owner:u};return o._store={},Object.defineProperty(o._store,\"validated\",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(o,\"_self\",{configurable:!1,enumerable:!1,writable:!1,value:i}),Object.defineProperty(o,\"_source\",{configurable:!1,enumerable:!1,writable:!1,value:s}),Object.freeze&&(Object.freeze(o.props),Object.freeze(o)),o};function nn(e,n,t,i,s){{var u,l={},o=null,b=null;t!==void 0&&(fe(t),o=\"\"+t),Xe(n)&&(fe(n.key),o=\"\"+n.key),He(n)&&(b=n.ref,Ze(n,s));for(u in n)C.call(n,u)&&!Ke.hasOwnProperty(u)&&(l[u]=n[u]);if(e&&e.defaultProps){var c=e.defaultProps;for(u in c)l[u]===void 0&&(l[u]=c[u])}if(o||b){var f=typeof e==\"function\"?e.displayName||e.name||\"Unknown\":e;o&&Je(l,f),b&&Qe(l,f)}return en(e,o,b,s,i,D.current,l)}}var V=y.ReactCurrentOwner,pe=y.ReactDebugCurrentFrame;function w(e){if(e){var n=e._owner,t=S(e.type,e._source,n?n.type:null);pe.setExtraStackFrame(t)}else pe.setExtraStackFrame(null)}var z;z=!1;function B(e){return typeof e==\"object\"&&e!==null&&e.$$typeof===r}function he(){{if(V.current){var e=_(V.current.type);if(e)return`\n\nCheck the render method of \\``+e+\"`.\"}return\"\"}}function rn(e){{if(e!==void 0){var n=e.fileName.replace(/^.*[\\\\\\/]/,\"\"),t=e.lineNumber;return`\n\nCheck your code at `+n+\":\"+t+\".\"}return\"\"}}var _e={};function tn(e){{var n=he();if(!n){var t=typeof e==\"string\"?e:e.displayName||e.name;t&&(n=`\n\nCheck the top-level render call using <`+t+\">.\")}return n}}function ve(e,n){{if(!e._store||e._store.validated||e.key!=null)return;e._store.validated=!0;var t=tn(n);if(_e[t])return;_e[t]=!0;var i=\"\";e&&e._owner&&e._owner!==V.current&&(i=\" It was passed a child from \"+_(e._owner.type)+\".\"),w(e),m('Each child in a list should have a unique \"key\" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',t,i),w(null)}}function ge(e,n){{if(typeof e!=\"object\")return;if(Y(e))for(var t=0;t<e.length;t++){var i=e[t];B(i)&&ve(i,n)}else if(B(e))e._store&&(e._store.validated=!0);else if(e){var s=Ue(e);if(typeof s==\"function\"&&s!==e.entries)for(var u=s.call(e),l;!(l=u.next()).done;)B(l.value)&&ve(l.value,n)}}}function an(e){{var n=e.type;if(n==null||typeof n==\"string\")return;var t;if(typeof n==\"function\")t=n.propTypes;else if(typeof n==\"object\"&&(n.$$typeof===k||n.$$typeof===R))t=n.propTypes;else return;if(t){var i=_(n);ze(t,e.props,\"prop\",i,e)}else if(n.PropTypes!==void 0&&!z){z=!0;var s=_(n);m(\"Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?\",s||\"Unknown\")}typeof n.getDefaultProps==\"function\"&&!n.getDefaultProps.isReactClassApproved&&m(\"getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.\")}}function on(e){{for(var n=Object.keys(e.props),t=0;t<n.length;t++){var i=n[t];if(i!==\"children\"&&i!==\"key\"){w(e),m(\"Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.\",i),w(null);break}}e.ref!==null&&(w(e),m(\"Invalid attribute `ref` supplied to `React.Fragment`.\"),w(null))}}function ln(e,n,t,i,s,u){{var l=Ae(e);if(!l){var o=\"\";(e===void 0||typeof e==\"object\"&&e!==null&&Object.keys(e).length===0)&&(o+=\" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.\");var b=rn(s);b?o+=b:o+=he();var c;e===null?c=\"null\":Y(e)?c=\"array\":e!==void 0&&e.$$typeof===r?(c=\"<\"+(_(e.type)||\"Unknown\")+\" />\",o=\" Did you accidentally export a JSX literal instead of a component?\"):c=typeof e,m(\"React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s\",c,o)}var f=nn(e,n,t,s,u);if(f==null)return f;if(l){var p=n.children;if(p!==void 0)if(i)if(Y(p)){for(var j=0;j<p.length;j++)ge(p[j],e);Object.freeze&&Object.freeze(p)}else m(\"React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.\");else ge(p,e)}return e===x?on(f):an(f),f}}var sn=ln;q.Fragment=x,q.jsxDEV=sn})()});var De=G((jn,Ee)=>{\"use strict\";Ee.exports=je()});var xn={};bn(xn,{default:()=>gn,frontmatter:()=>_n});var a=pn(De()),_n={slug:\"/how-to-spend-60-dollars-on-a-7-mb-file\",date:\"2020-11-18T15:33:55.000Z\",title:\"How to Spend $60 to Store a 7mb File - Or Why You Should Write Unit Tests\",tags:[],summary:\"\",draft:!1};function ke(d){let r=Object.assign({p:\"p\",a:\"a\",code:\"code\",pre:\"pre\",span:\"span\"},d.components);return(0,a.jsxDEV)(a.Fragment,{children:[(0,a.jsxDEV)(r.p,{children:\"I'm not the best at writing automated tests. Sometimes I write them as I go, sometimes I write them before checking my code in, and sometimes I don't write them at all. This is bad practice, and I acknowledge it's an area where I need to improve. And today, I'll walk you through exactly why you shouldn't be like me.\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:9,columnNumber:1},this),(0,a.jsxDEV)(r.p,{children:\"A little background first:\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:11,columnNumber:1},this),(0,a.jsxDEV)(r.p,{children:[\"I'm working on a project for my company, \",(0,a.jsxDEV)(r.a,{href:\"https://pinata.cloud/\",children:\"Pinata\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:13,columnNumber:42},this),\", where we interact with the \",(0,a.jsxDEV)(r.a,{href:\"https://filecoin.io/\",children:\"Filecoin\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:13,columnNumber:104},this),\" blockchain. Filecoin works as an open-market, long-term storage solution for content. Unlike using a service like Amazon S3 Glacier, you can search for a storage provider (called miners) with rates you like and choose that provider to store your content for an agreed amount period of time. At the time of this writing, the minimum amount of time a storage deal can be made for is about six months.\"]},void 0,!0,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:13,columnNumber:1},this),(0,a.jsxDEV)(r.p,{children:'As part of the process for finding storage providers and proposing a \"contract\" to store the content, it is important (to us at least) to convert the cost of storage to USD. However, the conversion is not exactly straight forward.'},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:15,columnNumber:1},this),(0,a.jsxDEV)(r.p,{children:[\"Storage providers provide quotes for storage in a format called AttoFil. This is the smallest denomination of the Filecoin currency called FIL. One AttoFil is 10^-18 FIL. The quoted price is also for a single epoch of time (approximately 30 seconds) and is per GB. So for example, if someone quoted \",(0,a.jsxDEV)(r.code,{children:\"500000000\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:17,columnNumber:300},this),\", the calculation for cost in FIL for 30 seconds of storage would be:\"]},void 0,!0,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:17,columnNumber:1},this),(0,a.jsxDEV)(r.pre,{className:\"language-js\",children:(0,a.jsxDEV)(r.code,{className:\"language-js code-highlight\",children:(0,a.jsxDEV)(r.span,{className:\"code-line\",children:[(0,a.jsxDEV)(r.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:1,columnNumber:1},this),(0,a.jsxDEV)(r.span,{className:\"token number\",children:\"500000000\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:1,columnNumber:1},this),\" \",(0,a.jsxDEV)(r.span,{className:\"token operator\",children:\"*\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:1,columnNumber:1},this),\" \",(0,a.jsxDEV)(r.span,{className:\"token class-name known-class-name\",children:\"Math\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:1,columnNumber:1},this),(0,a.jsxDEV)(r.span,{className:\"token punctuation\",children:\".\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:1,columnNumber:1},this),(0,a.jsxDEV)(r.span,{className:\"token function method property-access\",children:\"pow\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:1,columnNumber:1},this),(0,a.jsxDEV)(r.span,{className:\"token punctuation\",children:\"(\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:1,columnNumber:1},this),(0,a.jsxDEV)(r.span,{className:\"token number\",children:\"10\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:1,columnNumber:1},this),(0,a.jsxDEV)(r.span,{className:\"token punctuation\",children:\",\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:1,columnNumber:1},this),\" \",(0,a.jsxDEV)(r.span,{className:\"token operator\",children:\"-\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:1,columnNumber:1},this),(0,a.jsxDEV)(r.span,{className:\"token number\",children:\"18\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:1,columnNumber:1},this),(0,a.jsxDEV)(r.span,{className:\"token punctuation\",children:\")\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:1,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\"},this)},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:19,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:19,columnNumber:1},this),(0,a.jsxDEV)(r.p,{children:\"That's pretty straight forward so far. But there are three additional variables missing in order to achieve our goal. We are storing content for about six months (In Epochs), we are not storing exactly one GB each time, and we need to know that we are not overpaying in USD.\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:23,columnNumber:1},this),(0,a.jsxDEV)(r.p,{children:[\"The first step was to calculate the current cost of FIL in USD. That's pretty easy. As of right now, the price of one FIL is $28.48. Next, we need to figure out what the cost of one AttoFil is in USD. To do that, we take \",(0,a.jsxDEV)(r.code,{children:\"28.48 * Math.pow(10, -18)\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:25,columnNumber:222},this),\". Next, we need to figure out the size of our file to store in bytes and convert that to GB. There are many ways to do this, but for simplicity, the calculation is essentially this:\"]},void 0,!0,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:25,columnNumber:1},this),(0,a.jsxDEV)(r.pre,{className:\"language-js\",children:(0,a.jsxDEV)(r.code,{className:\"language-js code-highlight\",children:[(0,a.jsxDEV)(r.span,{className:\"code-line\",children:[(0,a.jsxDEV)(r.span,{className:\"token keyword\",children:\"const\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:1,columnNumber:1},this),\" sizeInKb \",(0,a.jsxDEV)(r.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:1,columnNumber:1},this),\" \",(0,a.jsxDEV)(r.span,{className:\"token maybe-class-name\",children:\"FileSize\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:1,columnNumber:1},this),(0,a.jsxDEV)(r.span,{className:\"token operator\",children:\"/\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:1,columnNumber:1},this),(0,a.jsxDEV)(r.span,{className:\"token number\",children:\"1024\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:1,columnNumber:1},this),(0,a.jsxDEV)(r.span,{className:\"token punctuation\",children:\";\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:1,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\"},this),(0,a.jsxDEV)(r.span,{className:\"code-line\",children:[(0,a.jsxDEV)(r.span,{className:\"token keyword\",children:\"const\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:2,columnNumber:1},this),\" sizeInMb \",(0,a.jsxDEV)(r.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:2,columnNumber:1},this),\" sizeInKb\",(0,a.jsxDEV)(r.span,{className:\"token operator\",children:\"/\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:2,columnNumber:1},this),(0,a.jsxDEV)(r.span,{className:\"token number\",children:\"1024\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:2,columnNumber:1},this),(0,a.jsxDEV)(r.span,{className:\"token punctuation\",children:\";\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:2,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\"},this),(0,a.jsxDEV)(r.span,{className:\"code-line\",children:[(0,a.jsxDEV)(r.span,{className:\"token keyword\",children:\"const\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:3,columnNumber:1},this),\" sizeInGb \",(0,a.jsxDEV)(r.span,{className:\"token operator\",children:\"=\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:3,columnNumber:1},this),\" sizeInMb\",(0,a.jsxDEV)(r.span,{className:\"token operator\",children:\"/\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:3,columnNumber:1},this),(0,a.jsxDEV)(r.span,{className:\"token number\",children:\"1024\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:3,columnNumber:1},this),(0,a.jsxDEV)(r.span,{className:\"token punctuation\",children:\";\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:3,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\"},this)]},void 0,!0,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:27,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:27,columnNumber:1},this),(0,a.jsxDEV)(r.p,{children:\"Now, we need to calculate how many epochs (30 second periods of time) there are in six months. I'll save you the math and tell you it's about 518400 epochs.\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:33,columnNumber:1},this),(0,a.jsxDEV)(r.p,{children:\"With all of this information, the trick is calculating the right price to propose to the storage provider. There's no going back if they accept the proposal...even if you mess up and overpay. And that's exactly what happened to me.\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:35,columnNumber:1},this),(0,a.jsxDEV)(r.p,{children:\"I did not have a unit test in place to verify the price we would be paying did not exceed the price in USD we were comfortable with for six months of storage for any given file size. Because of this, I happened to query a storage provider who quoted a verify high price and a bug in my code missed the verification calculation. So, we ended up paying $60 to store a file that was about 7MB for six months.\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:37,columnNumber:1},this),(0,a.jsxDEV)(r.p,{children:\"The moral of this story is test, test, test.\"},void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:39,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\",lineNumber:1,columnNumber:1},this)}function vn(d={}){let{wrapper:r}=d.components||{};return r?(0,a.jsxDEV)(r,Object.assign({},d,{children:(0,a.jsxDEV)(ke,d,void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\"},this)}),void 0,!1,{fileName:\"/Users/polluterofminds/Development/tailwind-nextjs-starter-blog/_mdx_bundler_entry_point-9c33105f-bc83-4c53-a3e9-1011d4b57a6b.mdx\"},this):ke(d)}var gn=vn;return hn(xn);})();\n/*! Bundled license information:\n\nreact/cjs/react-jsx-dev-runtime.development.js:\n  (**\n   * @license React\n   * react-jsx-dev-runtime.development.js\n   *\n   * Copyright (c) Facebook, Inc. and its affiliates.\n   *\n   * This source code is licensed under the MIT license found in the\n   * LICENSE file in the root directory of this source tree.\n   *)\n*/\n;return Component;"
  },
  "_id": "blog/how-to-spend-60-dollars-on-a-7-mb-file.mdx",
  "_raw": {
    "sourceFilePath": "blog/how-to-spend-60-dollars-on-a-7-mb-file.mdx",
    "sourceFileName": "how-to-spend-60-dollars-on-a-7-mb-file.mdx",
    "sourceFileDir": "blog",
    "contentType": "mdx",
    "flattenedPath": "blog/how-to-spend-60-dollars-on-a-7-mb-file"
  },
  "type": "Blog",
  "readingTime": {
    "text": "3 min read",
    "minutes": 2.845,
    "time": 170700,
    "words": 569
  },
  "slug": "how-to-spend-60-dollars-on-a-7-mb-file",
  "path": "blog/how-to-spend-60-dollars-on-a-7-mb-file",
  "filePath": "blog/how-to-spend-60-dollars-on-a-7-mb-file.mdx",
  "toc": [],
  "structuredData": {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "How to Spend $60 to Store a 7mb File - Or Why You Should Write Unit Tests",
    "datePublished": "2020-11-18T15:33:55.000Z",
    "dateModified": "2020-11-18T15:33:55.000Z",
    "description": "",
    "image": "/static/images/twitter-card.png",
    "url": "https://polluterofminds.com/blog/how-to-spend-60-dollars-on-a-7-mb-file"
  }
}